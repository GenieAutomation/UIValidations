import { test, expect } from '@playwright/test';

test('test', async ({ page }) => {
  await page.goto('https://www.americanexpress.com/fr-fr/?inav=NavLogo');
  await page.getByTestId('granular-banner-button-accept-all').click();
  await expect(page.getByRole('link', { name: 'Cartes Particuliers' })).toBeVisible();
  await page.getByRole('link', { name: 'Cartes Particuliers' }).click();
  await expect(page.getByRole('link', { name: 'Carte Gold American&nbsp;' })).toBeVisible();
  await page.getByText('Cotisation Gratuite la 1ère').click();
  await expect(page.getByRole('link', { name: 'Carte Gold American&nbsp;' })).toBeVisible();
  await page.getByText('Cotisation Gratuite la 1ère').click();
  await page.getByRole('link', { name: 'En savoir plus' }).nth(1).click();
  await expect(page.getByText('Elle Assure et vous Rassure', { exact: true })).toBeVisible();
  await page.locator('#pdp-side-railwrapper').getByRole('link', { name: 'Demandez votre Carte' }).click();
  await expect(page.getByText('Souscrivez en quelques minutes')).toBeVisible();
  await page.locator('label').filter({ hasText: 'Mme' }).click();
  await page.getByRole('textbox', { name: 'Prénom' }).click();
  await page.getByRole('textbox', { name: 'Prénom' }).fill('Test');
  await page.getByRole('textbox', { name: 'Nom', exact: true }).click();
  await page.getByRole('textbox', { name: 'Nom', exact: true }).fill('Test');
  await page.getByRole('textbox', { name: 'Date de naissance (JJ/MM/AAAA)' }).click();
  await page.getByRole('textbox', { name: 'Date de naissance (JJ/MM/AAAA)' }).fill('12/12/1999');
  await page.getByRole('textbox', { name: 'Adresse e-mail' }).click();
  await page.getByRole('textbox', { name: 'Adresse e-mail' }).fill('est@test.com');
  await page.getByRole('textbox', { name: 'Numéro de téléphone portable' }).click();
  await page.getByRole('textbox', { name: 'Numéro de téléphone portable' }).fill('06897898765');
  await expect(page.getByRole('button', { name: 'Sauvegarder et Continuer' })).toBeVisible();
  await page.getByRole('button', { name: 'Sauvegarder et Continuer' }).click();
  await expect(page.getByRole('heading', { name: 'Vos informations personnelles' })).toBeVisible();
  await page.getByText('Cochez cette case si votre').click();
  await page.getByRole('textbox', { name: 'Lieu de naissance' }).click();
  await page.getByRole('textbox', { name: 'Lieu de naissance' }).fill('test');
  await page.getByRole('textbox', { name: 'N°, type et nom de la voie de' }).click();
  await page.getByRole('textbox', { name: 'N°, type et nom de la voie de' }).fill('church street');
  await expect(page.getByRole('button', { name: 'Sauvegarder et Continuer' })).toBeVisible();
  await page.getByRole('button', { name: 'Sauvegarder et Continuer' }).click();
  await expect(page.getByText('Département/région de')).toBeVisible();
  await expect(page.getByText('Votre code postal obligatoire')).toBeVisible();
  await expect(page.getByText('Nom de la ville obligatoire.')).toBeVisible();
  await expect(page.getByText('Merci de préciser votre')).toBeVisible();
  await page.getByLabel('Département de naissance').selectOption('005');
  await page.getByRole('textbox', { name: 'Code postal' }).click();
  await page.getByRole('textbox', { name: 'Code postal' }).fill('89987');
  await page.getByRole('textbox', { name: 'Ville' }).click();
  await page.getByRole('textbox', { name: 'Ville' }).fill('villa');
  await expect(page.getByLabel('Statut résidentiel')).toBeVisible();
  await page.getByLabel('Statut résidentiel').selectOption('MORTGAGE');
  await page.getByRole('button', { name: 'Sauvegarder et Continuer' }).click();
});